<?php
/*
      ___           ___           ___           ___           ___     
     /\  \         /\  \         /\__\         /\  \         /\  \    
     \:\  \       /::\  \       /::|  |       /::\  \       /::\  \   
      \:\  \     /:/\:\  \     /:|:|  |      /:/\:\  \     /:/\ \  \  
      /::\  \   /:/  \:\  \   /:/|:|__|__   /::\~\:\  \   _\:\~\ \  \ 
     /:/\:\__\ /:/__/ \:\__\ /:/ |::::\__\ /:/\:\ \:\__\ /\ \:\ \ \__\
    /:/  \/__/ \:\  \ /:/  / \/__/~~/:/  / \/__\:\/:/  / \:\ \:\ \/__/
   /:/  /       \:\  /:/  /        /:/  /       \::/  /   \:\ \:\__\  
   \/__/         \:\/:/  /        /:/  /        /:/  /     \:\/:/  /  
                  \::/  /        /:/  /        /:/  /       \::/  /   
                   \/__/         \/__/         \/__/         \/__/    
      ___           ___           ___           ___     
     /\  \         /\__\         /\__\         /\  \    
    /::\  \       /:/  /        /:/  /        /::\  \   
   /:/\:\  \     /:/  /        /:/  /        /:/\:\  \  
  /::\~\:\  \   /:/  /  ___   /:/  /  ___   /:/  \:\__\ 
 /:/\:\ \:\__\ /:/__/  /\__\ /:/__/  /\__\ /:/__/ \:|__|
 \/_|::\/:/  / \:\  \ /:/  / \:\  \ /:/  / \:\  \ /:/  /
    |:|::/  /   \:\  /:/  /   \:\  /:/  /   \:\  /:/  / 
    |:|\/__/     \:\/:/  /     \:\/:/  /     \:\/:/  /  
    |:|  |        \::/  /       \::/  /       \::/__/   
     \|__|         \/__/         \/__/         ~~       



Made by Tomas Ruud
http://tomasruud.com

This work is licensed under the Creative Commons Attribution-ShareAlike 3.0 Unported License.
To view a copy of this license, visit http://creativecommons.org/licenses/by-sa/3.0/

But you probably don't care..
(Just give me a little credit :P)

*/
?>
<?php
function clean($str) {
		$str = @trim($str);
		if(get_magic_quotes_gpc()) {
			$str = stripslashes($str);
		}
		return htmlspecialchars($str);
}
$file = clean($_GET['skin']);
$image = imagecreatefrompng($file);
imagealphablending($image, false);
imagesavealpha($image, true);

// start buffering
ob_start();
    $dest = imagecreatetruecolor(640, 320);
	$transparent = imagecolorallocate($dest, 200, 255, 200);
  	imagefill($dest, 0, 0, $transparent);
  	imagecolortransparent($dest, $transparent);
	
    imagecopyresized($dest, $image, 0, 0, 0, 0, 640, 320, 64, 32);

imagepng($dest);
$contents =  ob_get_contents();
ob_end_clean();

$skin = "data:image/png;base64,".base64_encode($contents)."";

imagedestroy($dest);
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Skinpreview</title>
<style>
/* Styling for the CC-thing.. I know you remove this anyway */
#cc {position:absolute;top:425px;left:420px;width:200px;color:#fff;font-family:Arial, Helvetica, sans-serif;}
#cc a {color:#bdbdbd;}

/* Body-style configurations */
body {background:#ccc url(bg.gif);margin:0;padding:0;}

/* Some font-styles */
#frnt_txt {position:absolute;top:325px;left:170px;color:#fff;font-family:Arial, Helvetica, sans-serif;}
#back_txt {position:absolute;top:325px;left:370px;color:#fff;font-family:Arial, Helvetica, sans-serif;}
#left_txt {position:absolute;top:325px;left:555px;color:#fff;font-family:Arial, Helvetica, sans-serif;}
#right_txt {position:absolute;top:325px;left:700px;color:#fff;font-family:Arial, Helvetica, sans-serif;}
#top_txt {position:absolute;top:325px;left:840px;color:#fff;font-family:Arial, Helvetica, sans-serif;}

/* Front preview configuration */
#face {position:absolute;height:80px;width:80px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:150px;background-position:-80px -80px;}
#hat {z-index:99;position:absolute;height:80px;width:80px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:150px;background-position:-400px -80px;}
#arm_l {position:absolute;height:120px;width:40px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:110px;top:80px;background-position:-440px -200px;}
#arm_r {position:absolute;height:120px;width:40px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:230px;top:80px;background-position:-440px -200px;}
#body {position:absolute;height:120px;width:80px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:150px;top:80px;background-position:-200px -200px;}
#bone_l {position:absolute;height:120px;width:40px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:150px;top:200px;background-position:-40px -200px;}
#bone_r {position:absolute;height:120px;width:40px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:190px;top:200px;background-position:-40px -200px;}

/* Back preview configuration */
#b_face {position:absolute;height:80px;width:80px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:350px;background-position:-240px -80px;}
#b_arm_l {position:absolute;height:120px;width:40px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:310px;top:80px;background-position:-520px -200px;}
#b_arm_r {position:absolute;height:120px;width:40px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:430px;top:80px;background-position:-520px -200px;}
#b_body {position:absolute;height:120px;width:80px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:350px;top:80px;background-position:-320px -200px;}
#b_bone_l {position:absolute;height:120px;width:40px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:350px;top:200px;background-position:-120px -200px;}
#b_bone_r {position:absolute;height:120px;width:40px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:390px;top:200px;background-position:-120px -200px;}
#b_hat {z-index:99;position:absolute;height:80px;width:80px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:350px;background-position:-560px -80px;}

/* Left preview configuration */
#l_face {position:absolute;height:80px;width:80px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:530px;background-position:-160px -80px;}
#l_arm {position:absolute;height:120px;width:40px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:540px;z-index:3;top:80px;background-position:-400px -200px;}
#l_body {position:absolute;height:120px;width:40px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:550px;top:80px;background-position:-280px -200px;}
#l_bone {position:absolute;height:120px;width:40px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:550px;top:200px;background-position:0px -200px;}
#l_hat {z-index:99;position:absolute;height:80px;width:80px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:530px;background-position:-480px -80px;}

/* Right preview configuration */
#r_face {position:absolute;height:80px;width:80px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:680px;background-position:-0px -80px;}
#r_arm {position:absolute;height:120px;width:40px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:710px;z-index:3;top:80px;background-position:-400px -200px;}
#r_body {position:absolute;height:120px;width:40px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:700px;top:80px;background-position:-160px -200px;}
#r_bone {position:absolute;height:120px;width:40px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:700px;top:200px;background-position:0px -200px;}
#r_hat {z-index:99;position:absolute;height:80px;width:80px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:680px;background-position:-320px -80px;}

/* Top preview configuration */
#t_face {position:absolute;height:80px;width:80px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:820px;background-position:-80px 0px;top:120px;z-index:1;}
#t_arm_r {position:absolute;height:40px;width:40px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:840px;z-index:3;top:80px;background-position:-440px -160px;}
#t_arm_l {position:absolute;height:40px;width:40px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:840px;z-index:3;top:200px;background-position:-440px -160px;}
#t_hat {z-index:99;position:absolute;height:80px;width:80px;background-image:url(<?php echo $skin; ?>);background-repeat:no-repeat;left:820px;top:120px;background-position:-400px 0px;z-index:3;}
</style>
</head>

<body style="padding-top:20px;">
<div style="width:300px;height:300px;position:relative;">
    <div id="frnt_txt"><b>Front</b></div>
    <div id="back_txt"><b>Back</b></div>
    <div id="left_txt"><b>Left</b></div>
    <div id="right_txt"><b>Right</b></div>
    <div id="top_txt"><b>Top</b></div>
    <div id="cc">
	<a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/3.0/80x15.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/InteractiveResource" property="dct:title" rel="dct:type">Minecraft Skin previewer</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://tomasruud.com/mcskin" property="cc:attributionName" rel="cc:attributionURL">Tomas Ruud</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
    </div>
    
    <div id="hat"></div>
    <div id="face"></div>
    <div id="arm_l"></div>
    <div id="arm_r"></div>
    <div id="body"></div>
    <div id="bone_l"></div>
    <div id="bone_r"></div>
    
    <div id="b_face"></div>
    <div id="b_hat"></div>
    <div id="b_arm_l"></div>
    <div id="b_arm_r"></div>
    <div id="b_body"></div>
    <div id="b_bone_l"></div>
    <div id="b_bone_r"></div>
    
    <div id="l_face"></div>
    <div id="l_hat"></div>
    <div id="l_arm"></div>
    <div id="l_body"></div>
    <div id="l_bone"></div>
    
    <div id="r_face"></div>
    <div id="r_hat"></div>
    <div id="r_arm"></div>
    <div id="r_body"></div>
    <div id="r_bone"></div>
    
    <div id="t_face"></div>
    <div id="t_hat"></div>
    <div id="t_arm_l"></div>
    <div id="t_arm_r"></div>
</div>
</body>
</html>
